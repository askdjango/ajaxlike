{% extends "blog/base.html" %}

{% block content %}
<style>
.post_like_button {
    cursor: pointer;
}
</style>

    <h1>{{ post.title }}</h1>

    <h3>Like <span id="post_{{ post.id }}_like_count">{{ post.like_count }}</span></h3>

    {% if user.is_authenticated %}
        <span class="post_like_button"
            data-url="{% url "blog.views.post_like" post.pk %}"
            data-target-id="post_{{ post.id }}_like_count">좋아요</span>
    {% else %}
        {# Like 하실려면, <a href="{% url "login" %}">로그인</a>을 해주세요. #}
        Like 하실려면, 로그인을 해주세요.
    {% endif %}

    {{ post.content|linebreaks }}

    <script>
    $(function() {
        $(".post_like_button").click(function() {
            var like_url = $(this).data('url');
            var target_id = $(this).data('target-id');
            $.get(like_url).
                done(function(data) {
                    $('#' + target_id).html(data.like_count);
                }).
                fail(function() {
                    alert('failed');
                });
            return false;
        });
    });
    </script>
{% endblock %}
